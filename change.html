<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <title>用戶資料轉移介面</title>
</head>
<body>
  <h2>從 Sheet3 轉移資料到 用戶ID 工作表</h2>

  <label for="categorySelect">選擇分類：</label>
  <select id="categorySelect">
    <option value="開發">開發</option>
    <option value="服務">服務</option>
  </select>

  <br><br>
  <button id="btnTransfer" onclick="transferData()">開始執行轉移</button>

  <p id="transferResult"></p>

  <script>
    async function transferData() {
      const selectedCategory = document.getElementById("categorySelect").value;
      document.getElementById("transferResult").innerText = "轉移中...";

      try {
        // 假設資料列 index 1~10
        const rowsToTransfer = [];
        for(let i=1; i<=10; i++) {
          rowsToTransfer.push(i);
        }

        const response = await fetch("https://script.google.com/macros/s/AKfycbxndZDNdJcSfk5ZX-5zKk9sFSQ_2CCDjYAUKwBvcVlyjmwwHWYib5CbzhItx9kFvyH1/exec", {
          method: "POST",
          headers: {
            "Content-Type": "application/json"
          },
          body: JSON.stringify({
            action: "transferData",
            item: selectedCategory,
            rows: rowsToTransfer,
            autoDeleteAfterTransfer: false
          })
        });

        const result = await response.json();
        document.getElementById("transferResult").innerText = result.message || result.error;
      } catch (error) {
        document.getElementById("transferResult").innerText = "錯誤：" + error.message;
      }
    }
  </script>
</body>
</html>
